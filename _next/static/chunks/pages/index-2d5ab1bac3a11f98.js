(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return c(2485)}])},2485:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return u}});var d=c(1799),e=c(9396),f=c(5893),g=c(9008),h=c.n(g),i=c(7294),j=c(120),k=c(3461),l=c(6483),m=c(603),n=c(4113),o=c.n(n);function p(a){var b=a.onChangeFiles,c=a.acceptType,d=a.filename,e=function(a){a.preventDefault(),a.stopPropagation(),"dragenter"===a.type||"dragover"===a.type?n(!0):"dragleave"===a.type&&n(!1)},g=function(a){a.preventDefault(),a.stopPropagation(),n(!1),a.dataTransfer.files&&a.dataTransfer.files[0]&&b(a.dataTransfer.files)},h=function(a){a.preventDefault(),a.target.files&&a.target.files[0]&&b(a.target.files)},j=function(){var a;null===(a=p.current)|| void 0===a||a.click()},k=(0,m.Z)(i.useState(!1),2),l=k[0],n=k[1],p=i.useRef(null);return(0,f.jsxs)("form",{className:o().formFileUpload,onDragEnter:e,onSubmit:function(a){return a.preventDefault()},onClick:j,children:[(0,f.jsx)("input",{ref:p,type:"file",className:o().inputFileUpload,multiple:!0,onChange:h,accept:c}),(0,f.jsx)("label",{className:"".concat(o().labelFileUpload," ").concat(l?"dragActive":""),htmlFor:"inputFileUpload",children:(0,f.jsxs)("div",{children:[(0,f.jsxs)("p",{children:["Drag and drop the ",c," file here, or click to browse."]}),d&&(0,f.jsx)("p",{children:(0,f.jsx)("code",{children:d})})]})}),l&&(0,f.jsx)("div",{className:o().dragFileElement,onDragEnter:e,onDragLeave:e,onDragOver:e,onDrop:g})]})}var q=c(214),r=c.n(q),s=c(8869),t=function(){var a=function(a){var b="data-table";a=a.replace(/(\<table)(\ style\=\"width:115%\;\ padding-top\:10px\;\"\>)/,function(a,c,d){return[c,' id="'.concat(b,'"'),d].join("")});var c=l.ZP.load(a)("#".concat(b," table"));c.find("tr").first().find("td").each(function(a,b){return b.tagName="th"});var d=c.find("tr:nth-child(2)");if(!d.text().includes("Saldo Inicial"))throw Error('table format changed. Second row was not "Saldo Inicial"');return d.remove(),c.toString()},b=function(b){var c=s.parse(a(b));if(1!==c.count)throw Error('table format changed. Second row was not "Saldo Inicial"');n(c.results[0])},c=function(a){if(1!==a.length)throw Error("more than one file was included");var c=a[0];t(c.name);var d=new FileReader;d.onload=function(){null!=d.result&&"string"==typeof d.result&&b(d.result)},d.readAsText(c)},g=(0,i.useState)([]),m=g[0],n=g[1],o=(0,i.useState)(""),q=o[0],t=o[1],u=(0,i.useMemo)(function(){return m.map(function(a){return(0,e.Z)((0,d.Z)({},a),{Fecha:j.ou.fromFormat(a.Fecha,"d/M/yyyy").toFormat("MM/dd/yyyy")})})},[m]),v=(0,i.useMemo)(function(){return m.map(function(a){return(0,e.Z)((0,d.Z)({},a),{Fecha:j.ou.fromFormat(a.Fecha,"d/M/yyyy").toFormat("MM/dd/yyyy"),Credito:1===Math.sign(Number(a.Monto))?a.Monto:"",Debito:-1===Math.sign(Number(a.Monto))?Math.abs(Number(a.Monto)):""})})},[m]);return(0,f.jsxs)("div",{className:r().container,children:[(0,f.jsxs)(h(),{children:[(0,f.jsx)("title",{children:"Web Utils"}),(0,f.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,f.jsxs)("main",{className:r().main,children:[(0,f.jsxs)("h1",{className:r().title,children:["Promerica ",'".xls"'," to .csv"]}),(0,f.jsxs)("p",{className:r().description,children:["Promerica CR outputs a so-called ",".xls"," format for bank statements. Turns out these morons just output an html file and changed the filename to ",'".xls"',". This tool parses that html and turns the main table into a csv file. Unfortunately, because of the nature of html/css, this tool will likely break when Promerica makes any changes to their site, since it functions like a scraper with html selectors."]}),(0,f.jsxs)("p",{children:["Additionally, this converts the date format from ",(0,f.jsx)("code",{children:"d/m/yyyy"})," to ",(0,f.jsx)("code",{children:"mm/dd/yyyy"}),"."]}),(0,f.jsxs)("div",{children:[(0,f.jsx)(p,{onChangeFiles:c,acceptType:".xls",filename:q}),m.length>0&&(0,f.jsxs)("div",{children:[(0,f.jsx)(k.CSVLink,{data:m,className:r().csvLink,filename:"output.csv",target:"_blank",children:"Download - No Modifications"}),(0,f.jsx)(k.CSVLink,{data:u,className:r().csvLink,filename:"output.csv",target:"_blank",children:"Download - mm/dd/yyyy"}),(0,f.jsx)(k.CSVLink,{data:v,headers:[{label:"Date",key:"Fecha"},{label:"Document",key:"Documento"},{label:"Description",key:"Descripci\xf3n"},{label:"Debit",key:"Debito"},{label:"Credit",key:"Credito"},],className:r().csvLink,filename:"output.csv",target:"_blank",children:"Download - General Ledger"})]})]})]})]})},u=t},4113:function(a){a.exports={formFileUpload:"DragAndDrop_formFileUpload__oLo6x",inputFileUpload:"DragAndDrop_inputFileUpload__4nBVh",labelFileUpload:"DragAndDrop_labelFileUpload__P5MLm",dragActive:"DragAndDrop_dragActive__fitsr",uploadButton:"DragAndDrop_uploadButton___nTLz",dragFileElement:"DragAndDrop_dragFileElement__de_10"}},214:function(a){a.exports={container:"Home_container__bCOhY",main:"Home_main__nLjiQ",csvLink:"Home_csvLink__8kjvh"}}},function(a){a.O(0,[455,774,888,179],function(){var b;return a(a.s=8312)}),_N_E=a.O()}])